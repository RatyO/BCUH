<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BCUH • BCUH</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="BCUH">
<meta property="og:description" content="BCUH">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BCUH</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/docs.html">BCUH</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ratyO/BCUH/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="docs_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>BCUH</h1>
            <h3 class="subtitle">University of Helsinki bias adjustment tools</h3>
                        <h4 class="author">Olle Räty</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ratyO/BCUH/blob/master/vignettes/docs.Rmd"><code>vignettes/docs.Rmd</code></a></small>
      <div class="hidden name"><code>docs.Rmd</code></div>

    </div>

    
    
<div id="bcuh" class="section level1">
<h1 class="hasAnchor">
<a href="#bcuh" class="anchor"></a>BCUH</h1>
<p>BCUH is a collection of simple univariate and bi-variate methods, which have been developed to combine information obtained from observation together with climate model simulations when constructing future temperature and precipitation projections.</p>
</div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This tutorial illustrates the use of R package BCUH in which several bias correction and delta change methods have been implemented following <span class="citation">Räisänen and Räty (2013)</span> and <span class="citation">Räty, Räisänen, and Ylhäisi (2014)</span>. In addition, a copula-based joint bias correction method designed for temperature and precipitation is available. The implementation of the copula-based algorithm is partially based on <span class="citation">Li et al. (2014)</span> with modifications from <span class="citation">Gennaretti, Sangelantoni, and Grenier (2015)</span>. These methods have become de facto standard in climate impact studies due to the need to take biases in climate model simulations with respect to the observed climate into account. An overview of the package structure is given together with a set of examples, which illustrate the use of the package. Also, the limitations of the implemented methods are discussed. Finally, we give a brief overview of other existing R tools, which have been built for similar purposes as BCUH.</p>
<p>#Installation</p>
<p>To install BCUH, the R package  needs to be installed on your operating system:</p>
<pre><code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages("devtools")</a></code></pre>
<p>With  the installation of  should be straightforward:</p>
<pre><code><a href="https://devtools.r-lib.org//reference/remote-reexports.html">devtools::install_github(RatyO/BCUH)</a></code></pre>
<p>code{BCUH} depends on several other packages, most notably , which is used in the copula-based bias correction method. These packages should be automatically installed along .</p>
<p>#Univariate method</p>
<p>The current version of  contains a total of 20 univariate methods. Ten of these methods have originally been designed for daily mean temperature, while the rest ten ten methods were designed to construct future projections of daily precipitation. Furthermore, these methods can be divided into two groups based on the projection strategy. Five methods for both variables are so-called delta change methods, which add simulated changes to the reference time series in different ways. The rest of the methods directly bias correct the scenario period data based on biases between the reference and control data in the calibration period. These methods range from simple time mean adjustment to more sophisticated parametric and non-parametric quantile mapping methods. All of these have been encapsulated in two S4 classes, which return the input data and parameters as a customised S4 object. However, to make the application to these methods easier, the package also contains a wrapper function , which automatically builds the correct objects and returns the adjusted data and the relevant meta data as a  object. The different elements of this object can be accessed using the class methods provided in the package.</p>
<p>We will next demonstrate how to use the wrapper functions using synthetic data. The package contains two data sets which emulate the behavior of daily mean temperature and precipitation. The first data set corresponds to observations which could have been collect at single site, while the second data mimics simulated temperature and precipitation with differing statistical properties for the time series.</p>
<pre><code><a href="https://github.com/ratyO/BCUH">library(BCUH)

data("obs")
data("model")</a></code></pre>
<p>In the first example, We illustrate how to use the package to construct projections of temperature. Here we only demonstrate the bias correction methods.</p>
<pre><code>bc6 &lt;- biasco(obs = varsO[,'temp'], ctrl = varsC[,'temp'], scen = varsC[,'temp'], type = "abs", method = "M6")
bc9 &lt;- biasco(obs = varsO[,'temp'], ctrl = varsC[,'temp'], scen = varsC[,'temp'], type = "abs", method = "M9")
</code></pre>
<p>Note that  has been selected, which indicates that the adjustment is not bounded as is the case for precipitation. Field  is used to select the method (M1-M10). Biasco creates an object of type , which contains the adjusted data and also some additional information related to the used data and projection method. For example,  looks something like:</p>
<pre><code>bc.object</code></pre>
<p>Next, we visualise the quantile distributions for the adjusted time series:</p>
<pre><code><a href="https://rdrr.io/r/graphics/plot.html">plot(quantile(dat(adj(dc1)), seq(0,1,0.01)), type = "l",
    main="Quantile plot", xlab = "%", ylab = "Celcius", ylim = c(-30,10))
lines(quantile(dat(adj(bc6)), seq(0,1,0.01)), lty = 2, col="orange")
lines(quantile(dat(adj(bc9)), seq(0,1,0.01)), lty = 1, col="orange")
lines(quantile(obs.ctrl$tas, seq(0,1,0.01)), col = "red")
lines(quantile(rcm.ctrl$tas, seq(0,1,0.01)), col = "blue")
lines(quantile(rcm.scen$tas, seq(0,1,0.01)), col = "blue", lty = 2)
legend("topleft", c("M1","M6","M9","Obs","Ctrl","Scen"),
      col = c("black","black","orange","red","blue","blue"), lty = c(1,1,2,1,1,2))</a></code></pre>
<p>Some parameters available for M5 and M10 require special attention. The most i</p>
<p>In the second example, we adjust the precipitation time series. To access proper methods, the  has to be selected.</p>
<pre><code>dc1 &lt;- biasco(obs = varsO[,'prec'], ctrl = varsC[,'prec'], scen = varsC[,'prec'] type = "ratio", method = "M1")
bc6 &lt;- biasco(obs = varsO[,'prec'], ctrl = varsC[,'prec'], scen = varsC[,'prec'], type = "ratio", method = "M6")</code></pre>
<p>Methods M4-M5 and M9-M10 are the delta change and bias correction forms of parametric and non-parametric quantile mapping, which aim to adjust the full marginal distribution.</p>
<pre><code>dc5 &lt;- biasco(obs = obs.ctrl$tas, ctrl = rcm.ctrl$tas, scen = rcm.scen$tas, type = "ratio", method = "M5", smooth)
bc10 &lt;- biasco(obs = obs.ctrl$tas, ctrl = rcm.ctrl$tas, scen = rcm.scen$tas, type = "ratio", method = "M10")</code></pre>
<p>Next, we visualise the quantile distributions for the adjusted time series:</p>
<pre><code><a href="https://rdrr.io/r/graphics/plot.html">plot(quantile(dat(adj(dc1)), seq(0,1,0.01)), type = "l",
    main="Quantile plot", xlab = "%", ylab = "Celcius", ylim = c(-30,10))
lines(quantile(dat(adj(bc1)), seq(0,1,0.01)), lty = 2)
lines(quantile(dat(adj(dc5)), seq(0,1,0.01)), lty = 1, col="orange")
lines(quantile(dat(adj(bc10)), seq(0,1,0.01)), lty = 2, col="orange")
lines(quantile(obs.ctrl$tas, seq(0,1,0.01)), col = "red")
lines(quantile(rcm.ctrl$tas, seq(0,1,0.01)), col = "blue")
lines(quantile(rcm.scen$tas, seq(0,1,0.01)), col = "blue", lty = 2)
legend("topleft", c("M1","M6","M5","M10","Obs","Ctrl","Scen"),
      col = c("black","black","orange","orange","red","blue","blue"), lty = c(1,2,1,1,2))</a></code></pre>
<p>Some parameters available for M5 and M10 require special attention. The most important one is , which defines the strength of smoothing of quantile distributions of  and  for bias correction methods and  and  for delta change methods. The default values have been chose according to <span class="citation">Räisänen and Räty (2013)</span> and <span class="citation">Räty, Räisänen, and Ylhäisi (2014)</span> (0.05  and 0.02 for ). In addition, methods M5 and M10 do not preserve changes in the mean values between  and . However, this can be done by selecting .</p>
<p>For precipitation an option to pre-adjust  and  based on the mean squared error (MSE) between  and  is available. To switch this on set . When this option is selected, both  and  are shifted “closer” to  before applying quantile mapping.</p>
<p>#Multivariate methods</p>
<p>In the current version of BCUH, only one bi-variate method is available is restricted to the adjustment of the joint distribution of temperature and precipitation. In this method the joint distribution of temperature and precipitation is adjusted by first decomposing the reference and modeled distribution in the calibration period separate marginal distributions and the copula, which described the. So far, bias correction of the dependence structure using Gaussian copula is only available in the package. The methods was originally introduced by Li et al. (2014) and further developed in <span class="citation">Gennaretti, Sangelantoni, and Grenier (2015)</span>. In this method the joint distribution of temperature and precipitation by first decomposing the joint distribution into separate marginal distributions.</p>
<p>#Limitations</p>
<p>As with all statistical methods, care should be taken, when applying BCUH methods in actual work. First, the implemented methods have not been designed for directly downscaling climate model simulations to higher resolutions <span class="citation">(<span class="citeproc-not-found" data-reference-id="maraun2013"><strong>???</strong></span>)</span> discussed some of the potential issues with such approach, which are particularly severe for precipitation. The main. Furthermore, spatial averages of data downscaled this way tend to exhibit overestimation of precipitation extremes and the fraction of wet days is also overestimated due to overcorrection of the drizzle effect. For temperature, these issues are less severe, as its values change more smoothly in space.</p>
<p>Another issue, which is currently under devate is whether the statistical bias correction methods should preserve the simulated trends. In the traditional form, quantile mapping can alter the simulated changes, which . While this issue has not fully been taken into account in the package, an option to force changes in the mean of the adjusted time series to the simulated change has been included (see the example above). Alternatively delta change methods could be applied, since these methods does not suffer the aforementioned issues, as they adjust the observed time series based on model simulated changes. However, a major limitation of delta change approach is that different correlation structures follow directly the observed ones in the constructed projections. Other more sophisticated methods, which pertain simulated changes at quantile level, while simultaneously pertain some of the advances of bias correction methods, i.e., the capability</p>
<p>#Other R packages</p>
<p> is just one of the possible R packages available to statistically adjust model simulations to biases in climate model simulationswith respect to the observed climate. For the sake of completeness, we give a brief overview of other existing packages, which the reader might find useful. One of the most comprehensive packages written in  has been developed in Santander (). The package contains a set of bias correction methods partly similar to the ones available in  and also methods designed for downscaling coarse resolution model simulations for impact study purposes.  is a part of  bundle, which has additional tools for downloading, pre-processing and visualising the bias corrected / downscaled climate data. Several other packages are also available.  contains implementations of different types of quantile mapping methods as described in Gudmunsson et al. (2012). Another method used to downscale the cumulative distribution function of a coarse resolution model simulation with respect to a local scale cumulative distribution function has been implemented in  package.</p>
<p> is one of the few packages, which contains implementations of three multivariate bias correction methods as described in <span class="citation">Cannon (2016)</span> and <span class="citation">Cannon (2017)</span>. These methods adjust different intervariable correlations. In all these methods, marginal distributions are adjusted using quantile delta mapping, which has been described in <span class="citation">Cannon, Sobie, and Murdock (2015)</span>. In principle, the package allows to use also other methods to adjust the marginal distributions, as a posterior adjustment is made to them in order to retain correct marginals. A more detailed description of the methods is available in the package documentation .</p>
<p>#Conclusions</p>
<p>This tutorial gives a brief overview of BCUH-package, which contains. It is hoped that researchers find this package useful in their studies.</p>
<p>#References</p>
<div id="refs" class="references">
<div id="ref-cannon2016">
<p>Cannon, Alex J. 2016. “Multivariate bias correction of climate model output: matching marginal distributions and intervariable dependence structure.” <em>J. Clim.</em> 29 (19): 7045–64. <a href="https://doi.org/10.1175/JCLI-D-15-0679.1">https://doi.org/10.1175/JCLI-D-15-0679.1</a>.</p>
</div>
<div id="ref-cannon2017">
<p>———. 2017. “Multivariate quantile mapping bias correction: an N-dimensional probability density function transform for climate model simulations of multiple variables.” <em>Clim. Dyn.</em>, 1–19. <a href="https://doi.org/10.1007/s00382-017-3580-6">https://doi.org/10.1007/s00382-017-3580-6</a>.</p>
</div>
<div id="ref-cannon2015">
<p>Cannon, Alex J., Stephen R. Sobie, and Trevor Q. Murdock. 2015. “Bias correction of GCM precipitation by quantile mapping: how well do methods preserve changes in quantiles and extremes?” <em>J. Clim.</em> 28 (17): 6938–59. <a href="https://doi.org/10.1175/JCLI-D-14-00754.1">https://doi.org/10.1175/JCLI-D-14-00754.1</a>.</p>
</div>
<div id="ref-gennaretti2015">
<p>Gennaretti, Fabio, Lorenzo Sangelantoni, and Patrick Grenier. 2015. “Toward Daily Climate Scenarios for Canadian Arctic Coastal Zones with More Realistic Temperature-Precipitation Interdependence.” <em>J. Geophys. Res.-Atmos.</em> 120 (23): 11, 862–11, 877. <a href="https://doi.org/10.1002/2015JD023890">https://doi.org/10.1002/2015JD023890</a>.</p>
</div>
<div id="ref-li2014">
<p>Li, Chao, Eva Sinha, Daniel E. Horton, Noah S. Diffenbaugh, and Anna M. Michalak. 2014. “Joint Bias Correction of Temperature and Precipitation in Climate Model Simulations.” <em>J. Geophys. Res.-Atmos.</em> 119 (23): 13, 153–13, 162. <a href="https://doi.org/10.1002/2014JD022514">https://doi.org/10.1002/2014JD022514</a>.</p>
</div>
<div id="ref-raisanen2013">
<p>Räisänen, Jouni, and Olle Räty. 2013. “Projections of Daily Mean Temperature Variability in the Future: Cross-Validation Tests with Ensembles Regional Climate Simulations.” <em>Clim. Dyn.</em> 41 (5): 1553–68. <a href="https://doi.org/10.1007/s00382-012-1515-9">https://doi.org/10.1007/s00382-012-1515-9</a>.</p>
</div>
<div id="ref-raty2014">
<p>Räty, Olle, Jouni Räisänen, and Jussi S. Ylhäisi. 2014. “Evaluation of Delta Change and Bias Correction Methods for Future Daily Precipitation: Intermodel Cross-Validation Using Ensembles Simulations.” <em>Clim. Dyn.</em> 42 (9): 2287–2303. <a href="https://doi.org/10.1007/s00382-014-2130-8">https://doi.org/10.1007/s00382-014-2130-8</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Olle Räty.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
